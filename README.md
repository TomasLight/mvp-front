# BizarreLab client-side application

Веб приложение состоит из двух проектов:
* [https://github.com/BizarreLab/bizarre-monster](https://github.com/BizarreLab/bizarre-monster)
* [https://github.com/BizarreLab/mvp-front](https://github.com/BizarreLab/mvp-front)

### <a name="build"></a> Сборка
Скопируйте содержимое файла `/.env.example` в `/.env`

Чтобы собрать приложение выполните следующие команды в корне проекта
```
npm i
npm run prod
```

### Запуск dev-окружения

Для запуска dev-окружения необходимо:

1. Внести изменения в файл hosts, добавить два хоста:
```
127.0.0.1       bizarre-dev.rest
127.0.0.1       shaurma-zbs.bizarre-dev.rest
```

2. Установить самоподписный сертификат из файла `nginx-selfsigned.crt` и дать ему все права.

3. Выполнить `docker-compose up`.

Compose поднимет окружение, включающее базу данных, api и nginx. 

Детали конфига nginx:
- слушает порты 80 и 443, <b>важно</b> отключить все остальные веб-серверы, которые могут быть настроены на эти порты;
- настроен автоматический редирект с http на https;
- проксирует запросы к api, все методы api доступны с префиксом /api, например, `https://bizarre-dev.rest/api/users/signed`, но есть исключение, методы `/signin` и `/signout` работают без префикса;
- веб-сервер настроен на директорию public, т.е. веб-приложение должно быть заранее собрано.

### <a name="config"></a> Настройка
Можно изменить конфигурацию проекта через файл `/.env`

`MOCK_API` - использовать ли настоящий api или его mock объект

`API_BASE_URL` - базовый путь к api

Здесь же можно изменить api адреса. 
<b>Будьте осторожны</b>, если вы захотите радикально изменить api адреса, то mock api может перестать работать, т.к. там используются регулярные выражения для перехвата запросов.

Например `/menus/{menuId}/categories` сейчас проверяется раньше, чем `/menus/{menuId}`, потому что второй адрес более общий. Надеюсь, вы поняли меня))
